<!DOCTYPE>
<html lang="en">
	<head>
		<title>Chilipote's Memory Game</title>

		<!-- LESS -->
		<link rel="stylesheet/less" type="text/css" href="./assets/less/reset.less">
		<link rel="stylesheet/less" type="text/css" href="./assets/less/bootstrap.less">
		<link rel="stylesheet/less" type="text/css" href="./assets/less/bootstrap-responsive.less">
		<link rel="stylesheet/less" type="text/css" href="./assets/less/design.less">
		
		<!-- SCRIPT -->

		<script type="text/javascript" src="./assets/js/less.js"></script>

		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8">


	</head>
	<body>


		<div class="container-fluid">
			<div  class="row-fluid">
				<div class="span2 well" id="sidebar">
					<div class="row-fluid score">
						<h4>SCORE :</h4>
						<p id="score" >0</p>
					</div>
					<div class="row-fluid replay">
						<h4>REJOUER :</h4>

					</div>
				</div>

				<div class="span10" id="game">

				</div>
			</div>
		</div>

		<footer>
		 	<div class="row-fluid">
				<p>Allan Bettarel © | 2013</p>
		 	</div>
		</footer>




		<div class="modal hide fade" id="levelModal">
		  <div class="modal-header">
		    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		  </div>
		  <div class="modal-body">
		  	<form>
		  		<fieldset>
		  			<legend>
		  			Choisissez votre difficulté
		  			</legend>
				  	<label class="radio">
				      <input type="radio" name="nbOfRow" id="1" value="4"> 
				      Facile
				    </label>
				  	<label class="radio" >
				      <input type="radio" name="nbOfRow" id="2" value="6"> 
				      Moyen
				    </label>
				  	<label class="radio" >
				      <input type="radio" name="nbOfRow" id="3" value="8"> 
				      Difficile
				    </label>
		    	</fieldset>
		  	</form>
		  </div>
		  <div class="modal-error">	
		  </div>
		  <div class="modal-footer">
		    <a href="#" class="btn btn-primary level-valid">Save changes</a>
		  </div>
		</div>



		<script type="text/javascript" src="./assets/js/jquery.js"></script>
		<script type="text/javascript" src="./assets/js/bootstrap.js"></script>
		<script type="text/javascript" src="./assets/js/questions.js"></script>
		<script type="text/javascript" src="./assets/js/config.js"></script>
		<script type="text/javascript" src="./assets/js/functions.js"></script>
		<script type="text/javascript">

		var score = 0;
		var nbClick = 0;
		var FirstOfPair;
		var SecondOfPair;

		var gamerAnswers = [];

		 $(document).ready(function() {
		 		showModal();

		 		// CLICK ON VALID LEVEL
		 		$(".level-valid").click(function(){
		 			var nbOfRow = $('input[name=nbOfRow]:checked').val();
		 		
		 			if(!levelValueExist(nbOfRow)) {
							displayError();
							return false;
						}

						
						var nbPairMemoryItem = nbOfRow * _nbItemOnLine / 2;


						var array1 = new Array();
					var array2 = new Array();

						_setOfMemory.sort(function() { return 0.5 - Math.random() });

						var setOfMemoryForGame = _setOfMemory.splice(0,nbPairMemoryItem);

					for (var a = setOfMemoryForGame.length; a > 0; a-- ) {
						array1.push(setOfMemoryForGame[a-1]);
						array2.push(setOfMemoryForGame[a-1]);
					}	 				
					array2.sort(function() { return 0.5 - Math.random() });

						var setOfMemoryReadyToUse = array1.concat(array2);

		 			var z = 0;

		 			for (var i = nbOfRow; i > 0; i--) {

		 				$("#game").prepend("<div id="+i+" class=\"row-fluid\"></div>");

		 				for (var j = _nbItemOnLine; j > 0; j--) {
		 					setOfMemoryReadyToUse[z]["question"].toString();
		 					$("#"+i).append("<div data-id="+z+" data-answer="+setOfMemoryReadyToUse[z]["id"]+" class=\"item item"+setOfMemoryReadyToUse[z]["id"]+" span"+_spanItem+"\"><div class=\"answer\"><p>#"+setOfMemoryReadyToUse[z]["question"].toString()+"</p></div></div>");
		 					z++;
		 					
		 				};
		 				console.log(z);
		 			};

		 			$("#levelModal").modal('hide');
		 		});

		 		// CLOSE POP UP
		 		$("#levelModal").on("hide",function(event) {
		 			var nbOfRow = $('input[name=nbOfRow]:checked').val();
		 					 		
		 			if(!levelValueExist(nbOfRow)) {
							displayError();

							// PAS DECOUPER EN FONCTION SINON LE RETURN FALSE N'EST PAS INTERPRETE
							return false;
						}
		 		});
		 	});

			$(document).on("click",".item", function() {

				if (nbClick == 0 ) {
					
					FirstOfPair = $(this);
					FirstOfPair.children().addClass('active');
					
					nbClick++;
					return false;
				}

				if (nbClick == 1) {
					$(this).children().addClass('active');
					SecondOfPair = $(this);



					if((FirstOfPair.data('id') != SecondOfPair.data('id')) && (FirstOfPair.data('answer') == SecondOfPair.data('answer'))) {
						
						score++;
						updateScoreCountView(score);

						window.setTimeout(removeTheClass , 1000);
						
						$(".item"+FirstOfPair.data('answer')).fadeOut('slow', function() {
							$(".item"+FirstOfPair.data('answer')).addClass('item-found');
						});
						
						cleanVariable();

					} else {

						window.setTimeout(removeTheClass , 1000);
						cleanVariable();
						console.log("count"+nbClick);

					}
				}

		 		// $(this).children().toggleClass;

		 	});
		</script>
	</body>
</html>